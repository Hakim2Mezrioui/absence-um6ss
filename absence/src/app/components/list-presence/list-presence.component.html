<div class="w-full max-w-md mx-auto my-6">
  <label for="search" class="block text-sm font-medium text-gray-700 mb-1">
    Rechercher...
  </label>
  <div class="relative">
    <input
      id="search"
      type="text"
      placeholder="Tapez pour rechercher..."
      class="w-full pl-10 pr-4 py-2 rounded-xl shadow-sm border border-gray-300 focus:outline-none focus:ring-2 focus:ring-green-700 focus:border-transparent transition duration-200"
      #valSearch
      (input)="handleSearch($event)"
    />
    <svg
      class="w-5 h-5 text-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2 pointer-events-none"
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 24 24"
      stroke="currentColor"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M21 21l-4.35-4.35M16.65 16.65A7.5 7.5 0 1016.65 2a7.5 7.5 0 000 15z"
      />
    </svg>
  </div>
</div>


<div class="w-full flex justify-center">
  <div class="custom-width">
    <p-table
      #dt
      [value]="etudiants"
      dataKey="id"
      editMode="row"
      [tableStyle]="{
        'min-width': '30rem',
        width: '100%',
        marginTop: '2rem',
        margin: 'auto'
      }"
      [rows]="20"
      [showCurrentPageReport]="true"
      [rowsPerPageOptions]="[20, 50, 100]"
      [globalFilterFields]="['matricule', 'name', 'faculte', 'promotion']"
      [paginator]="true"
      paginatorPosition="bottom"
    >
      <!-- <ng-template pTemplate="caption">
    <div class="d-flex justify-content-between">
      <button
        pButton
        label="Clear"
        class="p-button-outlined"
        icon="pi pi-filter-slash"
        (click)="clear(dt)"
      ></button>
      <span class="p-input-icon-left ml-auto">
        <i class="pi pi-search"></i>
        <input
          pInputText
          type="text"
          (input)="applyFilterGlobal($event, 'contains')"
          placeholder="Search keyword"
          value=""
          #inputFilter
        />
      </span>
    </div>
  </ng-template> -->
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="matricule" style="width: 20%">
            Matricule <p-sortIcon field="name"></p-sortIcon>
          </th>
          <th pSortableColumn="name" style="width: 40%">
            Name <p-sortIcon field="name"></p-sortIcon>
          </th>
          <th pSortableColumn="faculte" style="width: 20%">
            Faculte <p-sortIcon field="faculte"></p-sortIcon>
          </th>
          <th pSortableColumn="promotion" style="width: 20%">
            Promotion <p-sortIcon field="promotion"></p-sortIcon>
          </th>
          <th pSortableColumn="etatPresence" style="width: 10%">
            {{ this.totalPresent }}/{{ this.totalEtudiant
            }}<p-sortIcon field="etatPresence"></p-sortIcon>
          </th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-etudiant let-ri="rowIndex">
        <tr>
          <td>
            {{ etudiant.matricule }}
          </td>
          <td>
            {{ etudiant.name }}
          </td>
          <td>
            {{ etudiant.faculte }}
          </td>
          <td>
            {{ etudiant.promotion }}
          </td>
          <!-- <td [ngClass]="checkEtudiantMatricule(etudiant.matricule) ? 'bg-green-50 text-green-700' : 'bg-red-50 text-red-700'" class="text-center bg-green-50">
            <span>{{
              checkEtudiantMatricule(etudiant.matricule) ? "P" : "A"
            }}</span>
          </td> -->
          <td
            [ngClass]="
              etudiant.etatPresence === 'P'
                ? 'bg-green-50 text-green-700'
                : 'bg-red-50 text-red-700'
            "
          >
            {{ etudiant.etatPresence }}
          </td>
        </tr>
      </ng-template>
    </p-table>

    <div
      class="border-none w-full m-auto my-4"
      *ngIf="role == 'admin' || role == 'super-admin'"
    >
      <button
        (click)="handleExport()"
        class="w-fit outline-none bg-green-50 px-5 py-2 hover:bg-green-100 active:bg-green-200"
      >
        Exporter
      </button>
    </div>
  </div>
</div>
