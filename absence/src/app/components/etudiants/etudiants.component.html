<div class="w-full flex justify-center">
  <div class="custom-width">
    <div class="form-group border-collapse m-auto my-4" style="width: 37em">
      <label
        for="search"
        class="bg-green-50 text-green-700 rounded-t-md px-6 py-2 flex items-center"
        >Search ...</label
      >
      <input
        id="search"
        class="bg-green-50 text-green-700 rounded-b-md px-6 py-2 flex items-center outline-none w-full"
        #valSearch
        (input)="handleSearch($event)"
      />
    </div>

    <p-table
      #dt
      [value]="etudiants"
      dataKey="id"
      editMode="row"
      [tableStyle]="{
        'min-width': '30rem',
        width: '100%',
        marginTop: '2rem',
        margin: 'auto'
      }"
      [rows]="20"
      [showCurrentPageReport]="true"
      [rowsPerPageOptions]="[20, 50, 100]"
      [globalFilterFields]="[
        'matricule',
        'name',
        'faculte',
        'promotion',
        'groupe'
      ]"
      [paginator]="true"
      paginatorPosition="bottom"
    >
      <!-- <ng-template pTemplate="caption">
      <div class="d-flex justify-content-between">
        <button
          pButton
          label="Clear"
          class="p-button-outlined"
          icon="pi pi-filter-slash"
          (click)="clear(dt)"
        ></button>
        <span class="p-input-icon-left ml-auto">
          <i class="pi pi-search"></i>
          <input
            pInputText
            type="text"
            (input)="applyFilterGlobal($event, 'contains')"
            placeholder="Search keyword"
            value=""
            #inputFilter
          />
        </span>
      </div>
    </ng-template> -->
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="matricule" style="width: 20%">
            Matricule <p-sortIcon field="matricule"></p-sortIcon>
          </th>
          <th pSortableColumn="name" style="width: 30%">
            Name <p-sortIcon field="name"></p-sortIcon>
          </th>
          <th pSortableColumn="faculte" style="width: 20%">
            Faculte <p-sortIcon field="faculte"></p-sortIcon>
          </th>
          <th
            *ngIf="role == 'super-admin' || userFaculte == 'fsts'"
            pSortableColumn="option"
            style="width: 20%"
          >
            Option <p-sortIcon field="option"></p-sortIcon>
          </th>
          <th pSortableColumn="groupe" style="width: 20%">
            Groupe <p-sortIcon field="groupe"></p-sortIcon>
          </th>
          <th pSortableColumn="promotion" style="width: 20%">
            Promotion <p-sortIcon field="promotion"></p-sortIcon>
          </th>
          <th pSortableColumn="groupe" style="width: 10%"></th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-etudiant let-ri="rowIndex">
        <tr>
          <td>
            {{ etudiant.matricule }}
          </td>
          <td>
            {{ etudiant.name }}
          </td>
          <td>
            {{ etudiant.faculte }}
          </td>
          <td *ngIf="role == 'super-admin' || userFaculte == 'fsts'">
            {{ etudiant.option }}
          </td>
          <td>
            {{ etudiant.groupe }}
          </td>
          <td>
            {{ etudiant.promotion }}
          </td>
          <td>
            <i
              (click)="onDelete(etudiant.matricule)"
              class="bi bi-trash text-white bg-red-700 p-2 hover:bg-red-600 active:bg-red-700 rounded"
            ></i>
          </td>
        </tr>
      </ng-template>
    </p-table>

    <div class="border-none m-auto my-4">
      <button
        (click)="handleExport()"
        class="w-fit outline-none bg-green-50 px-5 py-2 hover:bg-green-100 active:bg-green-200"
      >
        Exporter
      </button>
    </div>
  </div>
</div>

<div *ngIf="loading">
  <app-loading></app-loading>
</div>
