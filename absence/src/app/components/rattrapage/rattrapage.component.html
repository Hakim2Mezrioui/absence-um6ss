<div>
  <form #f="ngForm" (submit)="onSubmit()" class="max-w-lg mx-auto p-6 bg-white rounded-lg">
    <!-- Section Faculté -->
    <div *ngIf="role == 'super-admin'" class="mb-5">
        <label class="block text-green-700 text-sm font-semibold mb-2">
            Faculté
        </label>
        <select 
            class="w-full px-4 py-2.5 rounded-lg border border-green-100 focus:border-green-500 focus:ring-1 focus:ring-green-300 outline-none transition-all duration-200 bg-white text-gray-800 shadow-sm hover:border-green-300"
            ngModel
            name="faculte"
        >
            <option class="text-gray-400" value="" disabled selected>
                Sélectionnez une faculté
            </option>
            <option *ngFor="let ecole of ecoles" [value]="ecole.name.toLowerCase()" class="text-gray-700">
                {{ ecole.name | titlecase }}
            </option>
        </select>
    </div>

    <!-- Bouton Import Étudiants -->
    <div class="mb-5">
        <label 
            for="import"
            class="flex justify-center items-center w-full px-4 py-2.5 border-2 border-dashed border-green-200 hover:border-green-300 rounded-lg bg-green-50 text-green-700 font-medium cursor-pointer transition-colors duration-200 hover:bg-green-100"
            *ngIf="role == 'super-admin' || role == 'admin'"
        >
            <i class="bi bi-upload mr-2 text-green-600"></i>
            <span>Importer des étudiants</span>
            <input 
                (change)="onFileSelected($event)"
                id="import"
                type="file"
                class="hidden"
                [files]=""
            />
        </label>
    </div>
    
    <!-- Date Picker -->
    <div class="mb-5">
        <label class="block text-green-700 text-sm font-semibold mb-2">
            Date de l'examen
        </label>
        <input
            type="date"
            class="w-full px-4 py-2.5 rounded-lg border border-green-100 focus:border-green-500 focus:ring-1 focus:ring-green-300 outline-none transition-all duration-200 bg-white text-gray-800 shadow-sm hover:border-green-300"
            name="date"
            ngModel
        />
    </div>

    <!-- Heures groupées -->
    <div class="mb-6">
        <label class="block text-green-700 text-sm font-semibold mb-2">
            Plage horaire
        </label>
        <div class="flex items-center gap-3">
            <input
                type="time"
                class="flex-1 px-4 py-2.5 rounded-lg border border-green-100 focus:border-green-500 focus:ring-1 focus:ring-green-300 outline-none transition-all duration-200 bg-white text-gray-800 shadow-sm hover:border-green-300"
                name="hour1"
                ngModel
            />
            <span class="text-green-500 font-medium">à</span>
            <input
                type="time"
                class="flex-1 px-4 py-2.5 rounded-lg border border-green-100 focus:border-green-500 focus:ring-1 focus:ring-green-300 outline-none transition-all duration-200 bg-white text-gray-800 shadow-sm hover:border-green-300"
                name="hour2"
                ngModel
            />
        </div>
    </div>

    <!-- Bouton Soumettre -->
    <div class="mt-8">
        <button
            type="submit"
            class="w-full px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-lg shadow transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-green-400 focus:ring-offset-2 hover:shadow-md"
        >
            <ng-container *ngIf="localStudents.length != 0">
                <i class="bi bi-arrow-clockwise mr-2"></i>
            </ng-container>
            {{ this.localStudents.length == 0 ? "Commencer le suivi" : "Actualiser les données" }}
        </button>
    </div>
</form>
</div>

<div *ngIf="isLoading">
  <app-loading></app-loading>
</div>

<app-list-presence
  [totalEtudiant]="totalEtudiant"
  [totalPresent]="totalPresent"
  [etudiants]="localStudents"
  [studiantsWithFaceId]="studiantsWithFaceId"
  *ngIf="localStudents.length > 0"
  [promotion]="'1 ere'"
></app-list-presence>
