<div class="min-h-screen bg-gradient-to-br from-slate-50 via-gray-100 to-slate-200 py-8">
  <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Header Ultra Professionnel -->
    <div class="mb-12">
      <div class="relative">
        <div class="absolute inset-0 bg-slate-50 rounded-3xl opacity-60"></div>
        
        <div class="relative bg-white border border-slate-200 rounded-3xl p-8 shadow-lg">
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-8">
              <!-- Logo Professionnel -->
              <div class="relative group">
                <div class="w-20 h-20 bg-blue-600 rounded-2xl flex items-center justify-center shadow-md group-hover:scale-105 transition-transform duration-300">
                  <span class="material-icons text-white text-3xl">cloud_upload</span>
                </div>
                <!-- Status Indicator -->
                <div class="absolute -top-1 -right-1 w-7 h-7 bg-green-600 rounded-full flex items-center justify-center shadow-md border-2 border-white">
                  <span class="material-icons text-white text-sm">check</span>
                </div>
              </div>
              
              <!-- Titre et Description -->
              <div class="space-y-3">
                <div class="flex items-center gap-4">
                  <h1 class="text-5xl font-black text-slate-900 leading-tight">
                    Import des Examens
                  </h1>
                  <div class="px-4 py-2 bg-blue-100 rounded-full border border-blue-200">
                    <span class="text-sm font-bold text-blue-800 uppercase tracking-wider">PRO</span>
                  </div>
                </div>
                <p class="text-xl text-slate-600 font-medium max-w-2xl">
                  Système d'importation avancé pour la gestion des examens universitaires
                </p>
                <div class="flex items-center gap-6">
                  <div class="flex items-center gap-2">
                    <div class="w-3 h-3 bg-green-600 rounded-full"></div>
                    <span class="text-sm font-semibold text-slate-700">Système opérationnel</span>
                  </div>
                  <div class="flex items-center gap-2">
                    <div class="w-3 h-3 bg-blue-600 rounded-full"></div>
                    <span class="text-sm font-semibold text-slate-700">Interface professionnelle</span>
                  </div>
                  <div class="flex items-center gap-2">
                    <div class="w-3 h-3 bg-slate-500 rounded-full"></div>
                    <span class="text-sm font-semibold text-slate-700">Sécurisé & fiable</span>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Actions Professionnelles -->
            <div class="flex gap-4">
              <button 
                (click)="downloadCSVTemplate()"
                class="group relative bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-2xl font-bold text-lg shadow-md hover:shadow-lg transition-all duration-300 hover:-translate-y-1"
              >
                <div class="relative flex items-center gap-3">
                  <span class="material-icons text-2xl group-hover:scale-110 transition-transform duration-300">download</span>
                  <span>Modèle CSV</span>
                </div>
              </button>
              <button 
                (click)="resetForm()"
                class="group relative bg-slate-600 hover:bg-slate-700 text-white px-8 py-4 rounded-2xl font-bold text-lg shadow-md hover:shadow-lg transition-all duration-300 hover:-translate-y-1"
              >
                <div class="relative flex items-center gap-3">
                  <span class="material-icons text-2xl group-hover:rotate-180 transition-transform duration-500">refresh</span>
                  <span>Réinitialiser</span>
                </div>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Formulaire d'import Ultra Professionnel -->
    <div class="relative mb-10">
      <div class="absolute inset-0 bg-slate-50 rounded-3xl opacity-60"></div>
      
      <div class="relative bg-white border border-slate-200 rounded-3xl p-10 shadow-lg">
        <!-- Header Professionnel -->
        <div class="flex items-center justify-between mb-10 pb-8 border-b-2 border-slate-200">
          <div class="flex items-center gap-6">
            <div class="relative group">
              <div class="w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center shadow-md group-hover:scale-105 transition-transform duration-300">
                <span class="material-icons text-white text-2xl">settings</span>
              </div>
            </div>
            <div>
              <h2 class="text-3xl font-black text-slate-900 mb-2">Configuration de l'import</h2>
              <p class="text-lg text-slate-600 font-medium">Paramètres avancés pour l'importation des examens</p>
              <div class="flex items-center gap-4 mt-3">
                <div class="flex items-center gap-2 px-3 py-1 bg-blue-100 rounded-full">
                  <div class="w-2 h-2 bg-blue-600 rounded-full"></div>
                  <span class="text-sm font-semibold text-blue-800">Configuration requise</span>
                </div>
                <div class="flex items-center gap-2 px-3 py-1 bg-slate-100 rounded-full">
                  <div class="w-2 h-2 bg-slate-500 rounded-full"></div>
                  <span class="text-sm font-semibold text-slate-800">Validation automatique</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      
      <form [formGroup]="importForm" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- Établissement -->
        <div class="group relative">
          <label class="flex items-center gap-3 text-sm font-bold text-slate-700 uppercase tracking-wider mb-4">
            <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center shadow-lg">
              <span class="material-icons text-white text-sm">business</span>
            </div>
            Établissement *
          </label>
          <div class="relative">
            <select
              formControlName="etablissement_id"
              class="w-full px-6 py-4 bg-white/80 backdrop-blur-sm border-2 border-slate-200 rounded-2xl text-slate-900 font-medium shadow-lg hover:shadow-xl focus:shadow-2xl focus:border-blue-600 focus:ring-4 focus:ring-blue-600/20 transition-all duration-300 hover:-translate-y-0.5 focus:-translate-y-1"
              [class.border-red-400]="isFieldInvalid('etablissement_id')"
              [class.focus:border-red-500]="isFieldInvalid('etablissement_id')"
            >
              <option value="">Sélectionner un établissement</option>
              <option *ngFor="let etablissement of etablissements" [value]="etablissement.id">
                {{ etablissement.name }}
              </option>
            </select>
            <div class="absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none">
              <span class="material-icons text-slate-400 text-xl">expand_more</span>
            </div>
          </div>
          <p *ngIf="isFieldInvalid('etablissement_id')" class="flex items-center gap-2 mt-3 text-sm font-semibold text-red-600 bg-red-50 px-4 py-2 rounded-xl border border-red-200">
            <span class="material-icons text-sm">error</span>
            {{ getErrorMessage('etablissement_id') }}
          </p>
        </div>

        <!-- Promotion -->
        <div class="group relative">
          <label class="flex items-center gap-3 text-sm font-bold text-slate-700 uppercase tracking-wider mb-4">
            <div class="w-8 h-8 bg-green-600 rounded-lg flex items-center justify-center shadow-lg">
              <span class="material-icons text-white text-sm">school</span>
            </div>
            Promotion *
          </label>
          <div class="relative">
            <select formControlName="promotion_id" class="w-full px-6 py-4 bg-white/80 backdrop-blur-sm border-2 border-slate-200 rounded-2xl text-slate-900 font-medium shadow-lg hover:shadow-xl focus:shadow-2xl focus:border-green-600 focus:ring-4 focus:ring-green-600/20 transition-all duration-300 hover:-translate-y-0.5 focus:-translate-y-1" [class.border-red-400]="isFieldInvalid('promotion_id')">
              <option value="">Sélectionner une promotion</option>
              <option *ngFor="let promotion of promotions" [value]="promotion.id">{{ promotion.name }}</option>
            </select>
            <div class="absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none">
              <span class="material-icons text-slate-400 text-xl">expand_more</span>
            </div>
          </div>
          <p *ngIf="isFieldInvalid('promotion_id')" class="flex items-center gap-2 mt-3 text-sm font-semibold text-red-600 bg-red-50 px-4 py-2 rounded-xl border border-red-200">
            <span class="material-icons text-sm">error</span>
            {{ getErrorMessage('promotion_id') }}
          </p>
        </div>

        <!-- Année universitaire -->
        <div class="group relative">
          <label class="flex items-center gap-3 text-sm font-bold text-slate-700 uppercase tracking-wider mb-4">
            <div class="w-8 h-8 bg-slate-600 rounded-lg flex items-center justify-center shadow-lg">
              <span class="material-icons text-white text-sm">calendar_today</span>
            </div>
            Année universitaire *
          </label>
          <div class="relative">
            <input type="text" formControlName="annee_universitaire" placeholder="2024-2025" class="w-full px-6 py-4 bg-white/80 backdrop-blur-sm border-2 border-slate-200 rounded-2xl text-slate-900 font-medium shadow-lg hover:shadow-xl focus:shadow-2xl focus:border-slate-600 focus:ring-4 focus:ring-slate-600/20 transition-all duration-300 hover:-translate-y-0.5 focus:-translate-y-1" [class.border-red-400]="isFieldInvalid('annee_universitaire')">
            <div class="absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none">
              <span class="material-icons text-slate-400 text-xl">date_range</span>
            </div>
          </div>
          <p *ngIf="isFieldInvalid('annee_universitaire')" class="flex items-center gap-2 mt-3 text-sm font-semibold text-red-600 bg-red-50 px-4 py-2 rounded-xl border border-red-200">
            <span class="material-icons text-sm">error</span>
            {{ getErrorMessage('annee_universitaire') }}
          </p>
        </div>

        <!-- Type d'examen -->
        <div class="group relative">
          <label class="flex items-center gap-3 text-sm font-bold text-slate-700 uppercase tracking-wider mb-4">
            <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center shadow-lg">
              <span class="material-icons text-white text-sm">quiz</span>
            </div>
            Type d'examen *
          </label>
          <div class="relative">
            <select formControlName="type_examen_id" class="w-full px-6 py-4 bg-white/80 backdrop-blur-sm border-2 border-slate-200 rounded-2xl text-slate-900 font-medium shadow-lg hover:shadow-xl focus:shadow-2xl focus:border-blue-600 focus:ring-4 focus:ring-blue-600/20 transition-all duration-300 hover:-translate-y-0.5 focus:-translate-y-1" [class.border-red-400]="isFieldInvalid('type_examen_id')">
              <option value="">Sélectionner un type</option>
              <option *ngFor="let type of typesExamen" [value]="type.id">{{ type.name }}</option>
            </select>
            <div class="absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none">
              <span class="material-icons text-slate-400 text-xl">expand_more</span>
            </div>
          </div>
          <p *ngIf="isFieldInvalid('type_examen_id')" class="flex items-center gap-2 mt-3 text-sm font-semibold text-red-600 bg-red-50 px-4 py-2 rounded-xl border border-red-200">
            <span class="material-icons text-sm">error</span>
            {{ getErrorMessage('type_examen_id') }}
          </p>
        </div>

        <!-- Option -->
        <div class="group relative">
          <label class="flex items-center gap-3 text-sm font-bold text-slate-700 uppercase tracking-wider mb-4">
            <div class="w-8 h-8 bg-slate-600 rounded-lg flex items-center justify-center shadow-lg">
              <span class="material-icons text-white text-sm">tune</span>
            </div>
            Option
          </label>
          <div class="relative">
            <select formControlName="option_id" class="w-full px-6 py-4 bg-white/80 backdrop-blur-sm border-2 border-slate-200 rounded-2xl text-slate-900 font-medium shadow-lg hover:shadow-xl focus:shadow-2xl focus:border-slate-600 focus:ring-4 focus:ring-slate-600/20 transition-all duration-300 hover:-translate-y-0.5 focus:-translate-y-1">
              <option value="">Aucune option</option>
              <option *ngFor="let option of options" [value]="option.id">{{ option.name }}</option>
            </select>
            <div class="absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none">
              <span class="material-icons text-slate-400 text-xl">expand_more</span>
            </div>
          </div>
        </div>

        <!-- Salle -->
        <div class="group relative">
          <label class="flex items-center gap-3 text-sm font-bold text-slate-700 uppercase tracking-wider mb-4">
            <div class="w-8 h-8 bg-green-600 rounded-lg flex items-center justify-center shadow-lg">
              <span class="material-icons text-white text-sm">meeting_room</span>
            </div>
            Salle *
          </label>
          <div class="relative">
            <select formControlName="salle_id" class="w-full px-6 py-4 bg-white/80 backdrop-blur-sm border-2 border-slate-200 rounded-2xl text-slate-900 font-medium shadow-lg hover:shadow-xl focus:shadow-2xl focus:border-green-600 focus:ring-4 focus:ring-green-600/20 transition-all duration-300 hover:-translate-y-0.5 focus:-translate-y-1" [class.border-red-400]="isFieldInvalid('salle_id')">
              <option value="">Sélectionner une salle</option>
              <option *ngFor="let salle of salles" [value]="salle.id">{{ salle.name }}</option>
            </select>
            <div class="absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none">
              <span class="material-icons text-slate-400 text-xl">expand_more</span>
            </div>
          </div>
          <p *ngIf="isFieldInvalid('salle_id')" class="flex items-center gap-2 mt-3 text-sm font-semibold text-red-600 bg-red-50 px-4 py-2 rounded-xl border border-red-200">
            <span class="material-icons text-sm">error</span>
            {{ getErrorMessage('salle_id') }}
          </p>
        </div>

        <!-- Groupe -->
        <div class="group relative">
          <label class="flex items-center gap-3 text-sm font-bold text-slate-700 uppercase tracking-wider mb-4">
            <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center shadow-lg">
              <span class="material-icons text-white text-sm">group</span>
            </div>
            Groupe *
          </label>
          <div class="relative">
            <select formControlName="group_id" class="w-full px-6 py-4 bg-white/80 backdrop-blur-sm border-2 border-slate-200 rounded-2xl text-slate-900 font-medium shadow-lg hover:shadow-xl focus:shadow-2xl focus:border-blue-600 focus:ring-4 focus:ring-blue-600/20 transition-all duration-300 hover:-translate-y-0.5 focus:-translate-y-1" [class.border-red-400]="isFieldInvalid('group_id')">
              <option value="">Sélectionner un groupe</option>
              <option *ngFor="let group of groups" [value]="group.id">{{ group.title }}</option>
            </select>
            <div class="absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none">
              <span class="material-icons text-slate-400 text-xl">expand_more</span>
            </div>
          </div>
          <p *ngIf="isFieldInvalid('group_id')" class="flex items-center gap-2 mt-3 text-sm font-semibold text-red-600 bg-red-50 px-4 py-2 rounded-xl border border-red-200">
            <span class="material-icons text-sm">error</span>
            {{ getErrorMessage('group_id') }}
          </p>
        </div>

        <!-- Ville -->
        <div class="group relative">
          <label class="flex items-center gap-3 text-sm font-bold text-slate-700 uppercase tracking-wider mb-4">
            <div class="w-8 h-8 bg-slate-600 rounded-lg flex items-center justify-center shadow-lg">
              <span class="material-icons text-white text-sm">location_city</span>
            </div>
            Ville *
          </label>
          <div class="relative">
            <select formControlName="ville_id" class="w-full px-6 py-4 bg-white/80 backdrop-blur-sm border-2 border-slate-200 rounded-2xl text-slate-900 font-medium shadow-lg hover:shadow-xl focus:shadow-2xl focus:border-slate-600 focus:ring-4 focus:ring-slate-600/20 transition-all duration-300 hover:-translate-y-0.5 focus:-translate-y-1" [class.border-red-400]="isFieldInvalid('ville_id')">
              <option value="">Sélectionner une ville</option>
              <option *ngFor="let ville of villes" [value]="ville.id">{{ ville.name }}</option>
            </select>
            <div class="absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none">
              <span class="material-icons text-slate-400 text-xl">expand_more</span>
            </div>
          </div>
          <p *ngIf="isFieldInvalid('ville_id')" class="flex items-center gap-2 mt-3 text-sm font-semibold text-red-600 bg-red-50 px-4 py-2 rounded-xl border border-red-200">
            <span class="material-icons text-sm">error</span>
            {{ getErrorMessage('ville_id') }}
          </p>
        </div>
      </form>
    </div>

    <!-- Sélection de fichier Ultra Professionnelle -->
    <div class="relative mb-10">
      <div class="absolute inset-0 bg-gradient-to-br from-emerald-50 via-green-50 to-teal-50 rounded-3xl opacity-60"></div>
      <div class="relative bg-white/90 backdrop-blur-xl border border-white/30 rounded-3xl p-10 shadow-2xl">
        <div class="flex items-center gap-6 mb-10 pb-8 border-b-2 border-gradient-to-r from-emerald-200 via-green-200 to-teal-200">
          <div class="relative group">
            <div class="absolute inset-0 bg-gradient-to-r from-emerald-500 via-green-500 to-teal-500 rounded-2xl blur-lg opacity-60 group-hover:opacity-80 transition-opacity duration-300"></div>
            <div class="relative w-16 h-16 bg-gradient-to-br from-emerald-500 via-green-500 to-teal-500 rounded-2xl flex items-center justify-center shadow-xl group-hover:scale-105 transition-transform duration-300">
              <span class="material-icons text-white text-2xl">cloud_upload</span>
            </div>
          </div>
          <div>
            <h2 class="text-3xl font-black text-gray-900 mb-2">Sélection du fichier</h2>
            <p class="text-lg text-gray-600 font-medium">Glissez-déposez ou sélectionnez votre fichier d'import</p>
            <div class="flex items-center gap-4 mt-3">
              <div class="flex items-center gap-2 px-3 py-1 bg-emerald-100 rounded-full">
                <div class="w-2 h-2 bg-emerald-500 rounded-full"></div>
                <span class="text-sm font-semibold text-emerald-800">Drag & Drop</span>
              </div>
              <div class="flex items-center gap-2 px-3 py-1 bg-green-100 rounded-full">
                <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                <span class="text-sm font-semibold text-green-800">Format CSV/Excel</span>
              </div>
            </div>
          </div>
        </div>
      
        <div 
          class="border-4 border-dashed border-emerald-300 rounded-3xl p-16 text-center transition-all duration-500 hover:border-emerald-400 hover:bg-emerald-50/50"
          [class.border-emerald-500]="isDragOver"
          [class.bg-emerald-100/80]="isDragOver"
          [class.scale-105]="isDragOver"
          (dragover)="onDragOver($event)"
          (dragleave)="onDragLeave($event)"
          (drop)="onDrop($event)"
        >
          <div class="relative">
            <div class="w-32 h-32 bg-gradient-to-br from-emerald-100 to-green-100 rounded-full flex items-center justify-center mx-auto mb-8 shadow-2xl group-hover:scale-110 transition-transform duration-300">
              <span class="material-icons text-6xl text-emerald-600 transition-all duration-300" [class.scale-110]="isDragOver">
                cloud_upload
              </span>
            </div>
            <div *ngIf="isDragOver" class="absolute inset-0 bg-gradient-to-r from-emerald-400/20 to-green-400/20 rounded-full animate-pulse"></div>
          </div>
          
          <h3 class="text-3xl font-black text-gray-800 mb-4 transition-colors duration-300" [class.text-emerald-600]="isDragOver">
            {{ isDragOver ? 'Déposez votre fichier ici' : 'Sélectionnez un fichier' }}
          </h3>
          <p class="text-lg text-gray-600 mb-8 font-medium">Formats supportés : CSV, Excel (.xlsx)</p>
          
          <input type="file" (change)="onFileSelected($event)" accept=".csv,.xlsx" class="hidden" #fileInput>
          
          <button (click)="fileInput.click()" class="group relative bg-gradient-to-r from-emerald-600 to-green-600 hover:from-emerald-700 hover:to-green-700 text-white px-12 py-6 rounded-2xl font-bold text-xl shadow-2xl hover:shadow-emerald-500/25 transition-all duration-300 hover:-translate-y-2 hover:scale-105 border border-emerald-500/20">
            <div class="absolute inset-0 bg-gradient-to-r from-white/20 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
            <div class="relative flex items-center gap-4">
              <span class="material-icons text-2xl group-hover:scale-110 transition-transform duration-300">folder_open</span>
              <span>Choisir un fichier</span>
            </div>
          </button>
          
          <div *ngIf="selectedFile" class="mt-8 bg-gradient-to-r from-emerald-50 to-green-50 border-2 border-emerald-200 rounded-2xl p-6 shadow-lg">
            <div class="flex items-center gap-4">
              <div class="w-12 h-12 bg-gradient-to-br from-emerald-500 to-green-500 rounded-xl flex items-center justify-center shadow-lg">
                <span class="material-icons text-white text-xl">description</span>
              </div>
              <div class="flex-1 text-left">
                <p class="text-lg font-bold text-gray-800">{{ selectedFile.name }}</p>
                <p class="text-sm text-gray-600">{{ (selectedFile.size / 1024).toFixed(1) }} KB</p>
              </div>
              <div class="w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-500 rounded-full flex items-center justify-center shadow-lg">
                <span class="material-icons text-white">check</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    </div>

    <!-- Prévisualisation du fichier Ultra Élégante -->
    <div *ngIf="filePreview.length > 0" class="ultra-elegant-card mb-8">
      <div class="card-header">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl flex items-center justify-center shadow-lg">
            <span class="material-icons text-white text-lg">preview</span>
          </div>
          <div>
            <h2 class="text-2xl font-bold text-gray-900">Prévisualisation</h2>
            <p class="text-sm text-gray-600">Aperçu des 5 premières lignes de votre fichier</p>
          </div>
        </div>
      </div>
      
      <div class="preview-container">
        <div class="table-wrapper">
          <table class="ultra-elegant-table">
            <thead>
              <tr>
                <th *ngFor="let header of getHeaders()" class="table-header">
                  <div class="header-content">
                    <span class="material-icons text-sm mr-2">view_column</span>
                    {{ header }}
                  </div>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of filePreview; let i = index" class="table-row" [class.even]="i % 2 === 0">
                <td *ngFor="let header of getHeaders()" class="table-cell">
                  <div class="cell-content">
                    {{ item.row[header] || '' }}
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        
        <div class="preview-summary">
          <div class="summary-badge">
            <span class="material-icons text-blue-500">info</span>
            <span>Total des lignes à importer : <strong>{{ importResults.total }}</strong></span>
          </div>
        </div>
      </div>
    </div>

    <!-- Bouton d'import Ultra Professionnel -->
    <div class="relative mb-10">
      <div class="absolute inset-0 bg-gradient-to-br from-purple-50 via-pink-50 to-rose-50 rounded-3xl opacity-60"></div>
      <div class="relative bg-white/90 backdrop-blur-xl border border-white/30 rounded-3xl p-10 shadow-2xl">
        <div class="text-center">
          <button
            (click)="importExamens()"
            [disabled]="loading || !selectedFile || importForm.invalid"
            class="group relative bg-gradient-to-r from-purple-600 via-pink-600 to-rose-600 hover:from-purple-700 hover:via-pink-700 hover:to-rose-700 disabled:from-gray-400 disabled:to-gray-500 text-white px-16 py-8 rounded-3xl font-black text-2xl shadow-2xl hover:shadow-purple-500/25 disabled:shadow-none transition-all duration-500 hover:-translate-y-3 hover:scale-105 disabled:hover:translate-y-0 disabled:hover:scale-100 border border-purple-500/20 disabled:border-gray-300"
          >
            <div class="absolute inset-0 bg-gradient-to-r from-white/20 to-transparent rounded-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
            <div class="relative flex items-center gap-6">
              <span *ngIf="loading" class="material-icons animate-spin text-3xl">hourglass_empty</span>
              <span *ngIf="!loading" class="material-icons text-3xl group-hover:scale-110 transition-transform duration-300">cloud_upload</span>
              <span class="text-2xl font-black">
                {{ loading ? 'Import en cours...' : 'Importer les examens' }}
              </span>
            </div>
            <div *ngIf="loading" class="absolute bottom-0 left-0 h-2 bg-gradient-to-r from-white/40 to-transparent rounded-b-3xl animate-pulse"></div>
          </button>
          <p class="mt-6 text-lg text-gray-600 font-medium">Système d'importation sécurisé et fiable</p>
        </div>
      </div>
    </div>

    <!-- Messages Ultra Élégants -->
    <div *ngIf="error" class="mb-8">
      <div class="bg-gradient-to-r from-red-50 to-red-100 border-l-4 border-red-500 rounded-xl p-6 shadow-lg">
        <div class="flex items-center">
          <div class="w-12 h-12 bg-red-500 rounded-full flex items-center justify-center mr-4 shadow-lg">
            <span class="material-icons text-white text-xl">error</span>
          </div>
          <div>
            <h3 class="text-lg font-bold text-red-800">Erreur d'import</h3>
            <p class="text-red-700 mt-1">{{ error }}</p>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="success" class="mb-8">
      <div class="bg-gradient-to-r from-green-50 to-emerald-100 border-l-4 border-green-500 rounded-xl p-6 shadow-lg">
        <div class="flex items-center">
          <div class="w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mr-4 shadow-lg">
            <span class="material-icons text-white text-xl">check_circle</span>
          </div>
          <div>
            <h3 class="text-lg font-bold text-green-800">Import réussi</h3>
            <p class="text-green-700 mt-1">{{ success }}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Résultats Ultra Élégants -->
    <div *ngIf="importResults.total > 0" class="ultra-elegant-card mb-8">
      <div class="card-header">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg">
            <span class="material-icons text-white text-lg">analytics</span>
          </div>
          <div>
            <h2 class="text-2xl font-bold text-gray-900">Résultats de l'import</h2>
            <p class="text-sm text-gray-600">Statistiques détaillées de l'opération d'import</p>
          </div>
        </div>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <div class="bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-2xl p-6 text-center shadow-lg hover:shadow-xl transition-all duration-300">
          <div class="w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg">
            <span class="material-icons text-white text-2xl">assessment</span>
          </div>
          <p class="text-3xl font-bold text-blue-600 mb-2">{{ importResults.total }}</p>
          <p class="text-sm font-medium text-blue-800">Total</p>
        </div>
        <div class="bg-gradient-to-br from-green-50 to-emerald-100 border border-green-200 rounded-2xl p-6 text-center shadow-lg hover:shadow-xl transition-all duration-300">
          <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg">
            <span class="material-icons text-white text-2xl">check_circle</span>
          </div>
          <p class="text-3xl font-bold text-green-600 mb-2">{{ importResults.success }}</p>
          <p class="text-sm font-medium text-green-800">Succès</p>
        </div>
        <div class="bg-gradient-to-br from-red-50 to-red-100 border border-red-200 rounded-2xl p-6 text-center shadow-lg hover:shadow-xl transition-all duration-300">
          <div class="w-16 h-16 bg-red-500 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg">
            <span class="material-icons text-white text-2xl">error</span>
          </div>
          <p class="text-3xl font-bold text-red-600 mb-2">{{ importResults.errors }}</p>
          <p class="text-sm font-medium text-red-800">Erreurs</p>
        </div>
      </div>

      <!-- Détails des erreurs -->
      <div *ngIf="importResults.details.length > 0">
        <h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center">
          <span class="material-icons text-red-500 mr-2">list</span>
          Détails des erreurs
        </h3>
        <div class="bg-gradient-to-r from-gray-50 to-gray-100 rounded-2xl p-6 max-h-64 overflow-y-auto shadow-inner">
          <ul class="space-y-3">
            <li *ngFor="let detail of importResults.details" class="flex items-start text-sm text-gray-700 bg-white rounded-lg p-3 shadow-sm">
              <span class="material-icons text-red-400 text-sm mr-2 mt-0.5">error_outline</span>
              {{ detail }}
            </li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Instructions Ultra Élégantes -->
    <div class="bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 border border-blue-200 rounded-2xl p-8 shadow-xl">
      <div class="flex items-center gap-4 mb-6">
        <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg">
          <span class="material-icons text-white text-xl">info</span>
        </div>
        <h3 class="text-2xl font-bold bg-gradient-to-r from-blue-800 to-purple-800 bg-clip-text text-transparent">
          Instructions d'import
        </h3>
      </div>
      <div class="text-gray-700 space-y-4">
        <div class="bg-white rounded-xl p-6 shadow-lg">
          <p class="font-bold text-lg mb-3 text-gray-800">Format CSV attendu :</p>
          <p class="mb-4">Le fichier doit contenir les colonnes suivantes :</p>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="flex items-center gap-3 p-3 bg-blue-50 rounded-lg">
              <span class="material-icons text-blue-500">title</span>
              <div>
                <strong class="text-blue-800">title</strong>
                <p class="text-sm text-blue-600">Titre de l'examen (obligatoire)</p>
              </div>
            </div>
            <div class="flex items-center gap-3 p-3 bg-green-50 rounded-lg">
              <span class="material-icons text-green-500">date_range</span>
              <div>
                <strong class="text-green-800">date</strong>
                <p class="text-sm text-green-600">YYYY-MM-DD ou DD/MM/YYYY</p>
              </div>
            </div>
            <div class="flex items-center gap-3 p-3 bg-purple-50 rounded-lg">
              <span class="material-icons text-purple-500">schedule</span>
              <div>
                <strong class="text-purple-800">heure_debut</strong>
                <p class="text-sm text-purple-600">HH:MM, HHhMM, ou HH.MM</p>
              </div>
            </div>
            <div class="flex items-center gap-3 p-3 bg-orange-50 rounded-lg">
              <span class="material-icons text-orange-500">schedule</span>
              <div>
                <strong class="text-orange-800">heure_fin</strong>
                <p class="text-sm text-orange-600">HH:MM, HHhMM, ou HH.MM</p>
              </div>
            </div>
          </div>
        </div>
        <div class="bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-xl p-4">
          <p class="font-medium text-yellow-800">
            <span class="material-icons text-yellow-600 mr-2">lightbulb</span>
            <strong>Note :</strong> Les autres informations (établissement, promotion, salle, etc.) seront appliquées à tous les examens importés selon la configuration ci-dessus.
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
