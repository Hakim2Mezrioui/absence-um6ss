<div #sidebarRef 
     class="sidebar ultra-professional-sidebar"
     [ngClass]="{
       'w-72': !isCollapsed, 
       'w-16 collapsed': isCollapsed,
       'mobile-open': !isCollapsed && isMobile
     }"
     [attr.aria-expanded]="!isCollapsed"
     role="navigation"
     aria-label="Navigation principale">
  
  <!-- Header corporate premium -->
  <div class="sidebar-header">
    <div class="header-content">
      <!-- Logo et branding - caché en mode collapsed -->
      <div class="brand-section" 
           *ngIf="!isCollapsed">
        <div class="logo-container">
          <div class="logo-background">
            <div class="logo-icon">
              <span class="material-icons">school</span>
            </div>
            <div class="logo-glow"></div>
          </div>
        </div>
        <div class="brand-text">
          <h1 class="brand-title">UM6SS</h1>
          <p class="brand-subtitle">Gestion Absences</p>
        </div>
      </div>
      
      <!-- Toggle button premium - toujours visible -->
      <button 
        (click)="toggleSidebar()"
        class="toggle-button"
        [ngClass]="{'collapsed': isCollapsed}"
        [attr.aria-label]="isCollapsed ? 'Ouvrir le menu' : 'Fermer le menu'"
        [attr.aria-expanded]="!isCollapsed">
        <div class="toggle-icon">
          <span class="material-icons" [ngClass]="{'rotated': isCollapsed}">
            {{ isCollapsed ? 'menu' : 'menu_open' }}
          </span>
        </div>
      </button>
    </div>
  </div>

  <!-- Navigation premium -->
  <nav class="sidebar-nav" role="menubar">
    <div class="nav-container">
      <ng-container *ngFor="let item of sidebarItems; let i = index">
        <!-- Élément de navigation premium -->
        <div class="nav-item-wrapper" 
             [style.animation-delay]="getAnimationDelay(i)">
          <button 
            (click)="navigateTo(item.route)"
            (mouseenter)="onItemHover(item.route)"
            (mouseleave)="onItemLeave()"
            (touchstart)="onTouchStart($event)"
            (touchend)="onTouchEnd($event)"
            class="nav-item-premium"
            [ngClass]="{
              'active': isActiveRoute(item.route),
              'hovered': hoveredItem === item.route,
              'disabled': item.disabled
            }"
            [title]="getTooltipText(item)"
            [attr.aria-label]="item.label"
            [attr.aria-current]="isActiveRoute(item.route) ? 'page' : null"
            [attr.data-route]="item.route"
            role="menuitem"
            [disabled]="item.disabled">
            
            <!-- Container principal -->
            <div class="nav-item-content">
              <!-- Icône avec effets premium -->
              <div class="nav-icon-premium">
                <div class="icon-background">
                  <span class="material-icons">{{ item.icon }}</span>
                </div>
                <div class="icon-glow" 
                     [ngClass]="{'active': isActiveRoute(item.route)}"></div>
              </div>
              
              <!-- Contenu textuel -->
              <div class="nav-text-content" *ngIf="!isCollapsed">
                <span class="nav-label-premium">{{ item.label }}</span>
                <span *ngIf="item.badge" 
                      class="nav-badge-premium"
                      [attr.aria-label]="'Badge: ' + item.badge">
                  {{ item.badge }}
                </span>
              </div>
            </div>
            
            <!-- Indicateur de sélection premium -->
            <div class="nav-indicator-premium" 
                 [ngClass]="{'active': isActiveRoute(item.route)}"></div>
            
            <!-- Effet de hover premium -->
            <div class="nav-hover-effect"></div>
          </button>
        </div>
      </ng-container>
    </div>
  </nav>

  <!-- Footer utilisateur premium -->
  <div class="sidebar-footer">
    <div class="footer-content">
      <!-- Profil utilisateur corporate -->
      <div class="user-profile-section" 
           [ngClass]="{'collapsed': isCollapsed}">
        <div class="user-avatar-container">
          <div class="user-avatar">
            <div class="avatar-background">
              <span class="material-icons">person</span>
            </div>
            <div class="avatar-status-indicator"></div>
          </div>
        </div>
        <div class="user-info" *ngIf="!isCollapsed">
          <p class="user-name">Administrateur</p>
          <p class="user-role">Admin System</p>
        </div>
      </div>
      
      <!-- Actions utilisateur premium -->
      <div class="user-actions" *ngIf="!isCollapsed">
        <button class="action-button settings-btn" title="Paramètres">
          <div class="button-background">
            <span class="material-icons">settings</span>
          </div>
        </button>
        <button class="action-button logout-btn" title="Déconnexion">
          <div class="button-background">
            <span class="material-icons">logout</span>
          </div>
        </button>
      </div>
      
      <!-- Menu compact pour mode collapsed -->
      <div class="compact-menu" *ngIf="isCollapsed">
        <button class="compact-menu-button" title="Menu utilisateur">
          <div class="menu-dots">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Overlay pour mobile -->
<div *ngIf="isMobile && !isCollapsed" 
     class="sidebar-overlay"
     (click)="toggleSidebar()"
     [attr.aria-hidden]="true">
</div>
